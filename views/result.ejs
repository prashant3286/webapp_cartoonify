<html lang="en">
<head>
    <title>History page</title>
    <link rel='stylesheet' href='/css/style.css' />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />

    <style>
        a.cartoonify:hover {
            color: rgb(255, 230, 0);
        }

        a.history:hover {
            color: rgb(255, 230, 0);
        }

        a.cartoonify {
        color: white;
        font-size: big;
        text-decoration: none;
        float: left;
        font-weight:bold;
        text-decoration: underline;
        }
        
        a.history {
        color: white;
        font-size: big;
        text-decoration: none;
        float: right;
        font-weight:bold;
        text-decoration: underline;
        }
   
        #imgDisplay img{ 
            width:  200px;
            height: 200px;
            display: block;
            margin: 1rem;
            object-fit: contain;
             }
        
        
</style>
</head>
<body style="background-color: burlywood;">
   
    
    <div style="background-color:#d42121;text-align:center;padding:30px;margin-top:10px;">
        <a class="cartoonify" href="/"><span>CARTOONIFY</span></a>
        <a class="history" href="/result"><span> HISTORY</span></a>
      </div>
        <div class="container">
              <h1 style="padding-bottom: 15px;"><%= title %></h1>
              <table id="history">
                  <thead>
                      <tr>
                          <th>Id</th>
                          <th>Updated Date</th>
                          <th>Input Image</th>
                          <th>Output Image</th>
                          
                      </tr>
        
                  </thead>
                  <tbody>
                      <%if (records.length > 0){ %>
                          <% records.forEach(function(row){ %>
                            <tr>
                                <td><%= row._id %></td>
                                <td><%= row.updated_date %></td>
                                <td><%= row.input_img_path %></td>
                                <td><%= row.output_img_path %></td>
                                <td><button class="viewBtn">View</button></td>
                                
                            </tr>
                            <% }) %>
                        <% } %> 
                  </tbody> 
              </table>


    
      </div>

      <!-- image modal -->
      <!-- Button trigger modal -->

  
  <!-- Modal -->
  <div class="modal fade" id="imgModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="imgDisplay"></div>
        </div>
          <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
       
        </div>
      </div>
    </div>
  </div>
      <!-- image modal -->


      <script
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
    <script>
        $('.viewBtn').click(function(){
           
            var inputImg = $(this).parents('tr').find('td:nth-of-type(3)').text();
            var outputImg = $(this).parents('tr').find('td:nth-of-type(4)').text();

            var imgTemplate = `<div class="d-flex flex-wrap"><div><img src=${inputImg} /> Original image</div><div><img src=${outputImg} /> Cartoonified</div></div>`
          
            $('#imgDisplay').html('')
            $('#imgDisplay').append(imgTemplate)

            // show image popup
            $('#imgModal').modal('show')

            
        })
        
        
    </script>  
</body>
</html>